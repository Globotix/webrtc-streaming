<launch>
  <!-- Argument(s) -->
  <arg name="port" default="9091"/>
  <arg name="use_ip_camera" default="true"/>
  <arg name="use_back_camera" default="false"/>

  <!-- ICE: STUN/TURN Server -->
  <node name="ice_server_provider" pkg="webrtc_ros" type="ice_server_service.py">
    <rosparam param="stun_servers">
          ['stun:stun1.l.google.com:19302', 'stun:stun2.l.google.com:19302']
    </rosparam>
    <rosparam param="turn_server_uris">
        []
    </rosparam>
    <param name="turn_server_creds_uri" value=""/>
    <param name="turn_server_creds_username" value=""/>
    <param name="turn_server_creds_password" value=""/>
  </node>

  <!-- WebRTC ROS -->
  <node name="webrtc_server" pkg="webrtc_ros" type="webrtc_ros_server_node">
    <param name="port" value="$(arg port)"/>
  </node>

  <!-- <node pkg="image_transport" type="republish" name="image_transport_repub" args="theora in:=$(arg topic_in) out:=$(arg topic_out) _image_transport:=compressed"/> -->

  <node name="webrtc_router" pkg="webrtc_router" type="robot_router.py" output="screen">
    <rosparam command="load" file="$(find webrtc_router)/config/config.yaml" />
  </node>
  
  <!-- IP Cameras -->
  <group if="$(arg use_ip_camera)">
    <include file="$(find flexa_bringup)/launch/includes/ip_camera.launch.xml">
      <arg name="use_back_camera" value ="$(arg use_back_camera)"/>
    </include>
  </group>

</launch>
